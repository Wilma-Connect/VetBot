<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>VetBot ‚Äì Historique</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="styles/header.css">
</head>
<body class="bg-[#212121] pt-28 text-white min-h-screen p-4">
  <header class="header">
    <div class="header-nav">
      <select id="pageSelect" class="page-select">
        <option value="historique.html" selected>Historique</option>
        <option value="suivi.html">Suivi</option>
        <option value="conseils.html">Conseils</option>
        <option value="diagnostic.html">Diagnostic</option>
      </select>
      <button id="authButton" class="auth-button">Se connecter</button>
    </div>
  </header>

  <div class="max-w-4xl mx-auto">
    <h1 class="text-2xl font-bold mb-6">Historique des conversations</h1>
    
    <div class="space-y-4">
      <!-- Exemple d'entr√©e de diagnostic -->
      <div class="bg-gray-800 rounded-lg p-4 flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div class="text-red-500 text-2xl">üîç</div>
          <div>
            <h3 class="font-semibold">Diagnostic - Probl√®me respiratoire</h3>
            <p class="text-sm text-gray-400">12/03/2024 - 14:30</p>
          </div>
        </div>
        <div class="flex gap-2">
          <button class="bg-green-600 px-4 py-2 rounded hover:bg-green-700">Voir</button>
          <button class="bg-red-600 px-4 py-2 rounded hover:bg-red-700">Supprimer</button>
        </div>
      </div>

      <!-- Exemple d'entr√©e de suivi -->
      <div class="bg-gray-800 rounded-lg p-4 flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div class="text-blue-500 text-2xl">üìÖ</div>
          <div>
            <h3 class="font-semibold">Suivi - Vaccination Marek</h3>
            <p class="text-sm text-gray-400">10/03/2024 - 09:15</p>
          </div>
        </div>
        <div class="flex gap-2">
          <button class="bg-green-600 px-4 py-2 rounded hover:bg-green-700">Voir</button>
          <button class="bg-red-600 px-4 py-2 rounded hover:bg-red-700">Supprimer</button>
        </div>
      </div>

      <!-- Exemple d'entr√©e de diagnostic -->
      <div class="bg-gray-800 rounded-lg p-4 flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div class="text-red-500 text-2xl">üîç</div>
          <div>
            <h3 class="font-semibold">Diagnostic - Perte d'app√©tit</h3>
            <p class="text-sm text-gray-400">08/03/2024 - 16:45</p>
          </div>
        </div>
        <div class="flex gap-2">
          <button class="bg-green-600 px-4 py-2 rounded hover:bg-green-700">Voir</button>
          <button class="bg-red-600 px-4 py-2 rounded hover:bg-red-700">Supprimer</button>
        </div>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
  <script>
    // Fonction pour charger l'historique depuis le localStorage
    function loadHistory() {
      const history = JSON.parse(localStorage.getItem('vetbot_history') || '[]');
      const historyContainer = document.querySelector('.space-y-4');
      historyContainer.innerHTML = ''; // Vider le conteneur

      history.forEach(item => {
        const entry = document.createElement('div');
        entry.className = 'bg-gray-800 rounded-lg p-4 flex items-center justify-between';
        
        const icon = item.type === 'diagnostic' ? 'üîç' : 'üìÖ';
        const iconColor = item.type === 'diagnostic' ? 'text-red-500' : 'text-blue-500';
        
        entry.innerHTML = `
          <div class="flex items-center gap-4">
            <div class="${iconColor} text-2xl">${icon}</div>
            <div>
              <h3 class="font-semibold">${item.type === 'diagnostic' ? 'Diagnostic' : 'Suivi'} - ${item.title}</h3>
              <p class="text-sm text-gray-400">${new Date(item.date).toLocaleString()}</p>
            </div>
          </div>
          <div class="flex gap-2">
            <button onclick="viewEntry('${item.id}')" class="bg-green-600 px-4 py-2 rounded hover:bg-green-700">Voir</button>
            <button onclick="deleteEntry('${item.id}')" class="bg-red-600 px-4 py-2 rounded hover:bg-red-700">Supprimer</button>
          </div>
        `;
        
        historyContainer.appendChild(entry);
      });
    }

    // Fonction pour voir une entr√©e
    function viewEntry(id) {
      const history = JSON.parse(localStorage.getItem('vetbot_history') || '[]');
      const entry = history.find(item => item.id === id);
      if (entry) {
        if (entry.type === 'diagnostic') {
          window.location.href = `diagnostic.html?id=${id}`;
        } else {
          window.location.href = `suivi.html?id=${id}`;
        }
      }
    }

    // Fonction pour supprimer une entr√©e
    function deleteEntry(id) {
      if (confirm('√ätes-vous s√ªr de vouloir supprimer cette entr√©e ?')) {
        const history = JSON.parse(localStorage.getItem('vetbot_history') || '[]');
        const newHistory = history.filter(item => item.id !== id);
        localStorage.setItem('vetbot_history', JSON.stringify(newHistory));
        loadHistory();
      }
    }

    // Charger l'historique au chargement de la page
    document.addEventListener('DOMContentLoaded', loadHistory);
  </script>
</body>
</html>
